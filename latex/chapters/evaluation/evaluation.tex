\section{Evaluation und Ergebnisse}
\label{sec:validation}

In diesem Kapitel werden die Ergebnisse der Evaluationsläufe präsentiert.
Alle Modelle (vier Trainingsseeds pro Reward-Variante) sowie die beiden Baselines (Fixed-Time, Actuated)
wurden in allen vier Szenarien (\texttt{morning\_peak}, \texttt{evening\_peak}, \texttt{uniform}, \texttt{random\_heavy})
jeweils über zehn Episoden evaluiert.
Die Resultate sind Mittelwerte pro Kombination aus \emph{Methode} und \emph{Szenario}.

\subsection{Reward: Diff-Waiting-Time}
Die erste Gruppe von RL-Modellen wurde mit einem Reward trainiert, der die Differenz der Wartezeiten minimiert.

\subsubsection{Mittlere Wartezeit}

\begin{figure}[H]
    \centering
    \begin{tikzpicture}
        \begin{axis}[
                ybar,
                bar width=0.25cm,
                width=12cm,
                height=8cm,
                enlarge x limits=0.15,
                ylabel={Mittlere Wartezeit},
                symbolic x coords={evening_peak,morning_peak,random_heavy,uniform},
                xtick=data,
                xticklabels={evening\_peak,morning\_peak,random\_heavy,uniform},
                x tick label style={rotate=45,anchor=east},
                legend style={at={(0.5,-0.35)}, anchor=north, legend columns=-2},
                ymajorgrids=true,
                grid style=dashed,
                ymax=100
            ]

            % Baseline FixedTime
            \addplot+[error bars/.cd,
                y dir=both, y explicit,
                error bar style={line width=1pt, black}] table [
                    x=scenario, y=system_mean_waiting_time_mean, col sep=comma, y error=system_mean_waiting_time_std
                ] {chapters/evaluation/results/diff-waiting-time/Baseline_FixedTime.csv};
            \addlegendentry{Baseline FixedTime}

            % RL Modell 1
            \addplot+[error bars/.cd,
                y dir=both, y explicit,
                error bar style={line width=1pt, black}] table [
                    x=scenario, y=system_mean_waiting_time_mean, col sep=comma, y error=system_mean_waiting_time_std
                ] {chapters/evaluation/results/diff-waiting-time/ppo_sumo_456_2025-08-18_01-18-32_456.csv};
            \addlegendentry{Model 1}


            % RL Modell 2
            \addplot+[error bars/.cd,
                y dir=both, y explicit,
                error bar style={line width=1pt, black}] table [
                    x=scenario, y=system_mean_waiting_time_mean, col sep=comma, y error=system_mean_waiting_time_std
                ] {chapters/evaluation/results/diff-waiting-time/ppo_sumo_13755_2025-08-18_04-48-47_13755.csv};
            \addlegendentry{Model 2}

            % RL Modell 3
            \addplot+[error bars/.cd,
                y dir=both, y explicit,
                error bar style={line width=1pt, black}] table [
                    x=scenario, y=system_mean_waiting_time_mean, col sep=comma, y error=system_mean_waiting_time_std
                ] {chapters/evaluation/results/diff-waiting-time/ppo_sumo_143534_2025-08-17_23-30-08_143534.csv};
            \addlegendentry{Model 3}

            % RL Modell 4
            \addplot+[error bars/.cd,
                y dir=both, y explicit,
                error bar style={line width=1pt, black}] table [
                    x=scenario, y=system_mean_waiting_time_mean, col sep=comma, y error=system_mean_waiting_time_std
                ] {chapters/evaluation/results/diff-waiting-time/ppo_sumo_635768_2025-08-18_03-03-29_635768.csv};
            \addlegendentry{Model 4}
        \end{axis}
    \end{tikzpicture}
\end{figure}

\begin{figure}[H]
    \centering
    \begin{tikzpicture}
        \begin{axis}[
                ybar,
                bar width=0.25cm,
                width=12cm,
                height=8cm,
                enlarge x limits=0.15,
                ylabel={Mittlere Wartezeit},
                symbolic x coords={evening_peak,morning_peak,random_heavy,uniform},
                xtick=data,
                xticklabels={evening\_peak,morning\_peak,random\_heavy,uniform},
                x tick label style={rotate=45,anchor=east},
                legend style={at={(0.5,-0.35)}, anchor=north, legend columns=-2},
                ymajorgrids=true,
                grid style=dashed
            ]

            % Baseline Actuated
            \addplot+[error bars/.cd,
                y dir=both, y explicit,
                error bar style={line width=1pt, black}] table [
                    x=scenario, y=system_mean_waiting_time_mean, col sep=comma, y error=system_mean_waiting_time_std
                ] {chapters/evaluation/results/diff-waiting-time/Baseline_Actuated.csv};
            \addlegendentry{Baseline Actuated}
        \end{axis}
    \end{tikzpicture}
\end{figure}

\subsubsection{Gesammte Wartezeit}

\begin{figure}[H]
    \centering
    \begin{tikzpicture}
        \begin{axis}[
                ybar,
                bar width=0.25cm,
                width=12cm,
                height=8cm,
                enlarge x limits=0.15,
                ylabel={Gesammte Wartezeit},
                symbolic x coords={evening_peak,morning_peak,random_heavy,uniform},
                xtick=data,
                xticklabels={evening\_peak,morning\_peak,random\_heavy,uniform},
                x tick label style={rotate=45,anchor=east},
                legend style={at={(0.5,-0.35)}, anchor=north, legend columns=-2},
                ymajorgrids=true,
                grid style=dashed,
                ymax=12000
            ]

            % Baseline FixedTime
            \addplot+[error bars/.cd,
                y dir=both, y explicit,
                error bar style={line width=1pt, black}] table [
                    x=scenario, y=system_total_waiting_time_mean, col sep=comma, y error=system_total_waiting_time_std
                ] {chapters/evaluation/results/diff-waiting-time/Baseline_FixedTime.csv};
            \addlegendentry{Baseline FixedTime}

            % RL Modell 1
            \addplot+[error bars/.cd,
                y dir=both, y explicit,
                error bar style={line width=1pt, black}] table [
                    x=scenario, y=system_total_waiting_time_mean, col sep=comma, y error=system_total_waiting_time_std
                ] {chapters/evaluation/results/diff-waiting-time/ppo_sumo_456_2025-08-18_01-18-32_456.csv};
            \addlegendentry{Model 1}

            % RL Modell 2
            \addplot+[error bars/.cd,
                y dir=both, y explicit,
                error bar style={line width=1pt, black}] table [
                    x=scenario, y=system_total_waiting_time_mean, col sep=comma, y error=system_total_waiting_time_std
                ] {chapters/evaluation/results/diff-waiting-time/ppo_sumo_13755_2025-08-18_04-48-47_13755.csv};
            \addlegendentry{Model 2}

            % RL Modell 3
            \addplot+[error bars/.cd,
                y dir=both, y explicit,
                error bar style={line width=1pt, black}] table [
                    x=scenario, y=system_total_waiting_time_mean, col sep=comma, y error=system_total_waiting_time_std
                ] {chapters/evaluation/results/diff-waiting-time/ppo_sumo_143534_2025-08-17_23-30-08_143534.csv};
            \addlegendentry{Model 3}

            % RL Modell 4
            \addplot+[error bars/.cd,
                y dir=both, y explicit,
                error bar style={line width=1pt, black}] table [
                    x=scenario, y=system_total_waiting_time_mean, col sep=comma, y error=system_total_waiting_time_std
                ] {chapters/evaluation/results/diff-waiting-time/ppo_sumo_635768_2025-08-18_03-03-29_635768.csv};
            \addlegendentry{Model 4}
        \end{axis}
    \end{tikzpicture}
\end{figure}

\begin{figure}[H]
    \centering
    \begin{tikzpicture}
        \begin{axis}[
                ybar,
                bar width=0.25cm,
                width=12cm,
                height=8cm,
                enlarge x limits=0.15,
                ylabel={Gesammte Wartezeit},
                symbolic x coords={evening_peak,morning_peak,random_heavy,uniform},
                xtick=data,
                xticklabels={evening\_peak,morning\_peak,random\_heavy,uniform},
                x tick label style={rotate=45,anchor=east},
                legend style={at={(0.5,-0.35)}, anchor=north, legend columns=-2},
                ymajorgrids=true,
                grid style=dashed
            ]

            % Baseline Actuated
            \addplot+[error bars/.cd,
                y dir=both, y explicit,
                error bar style={line width=1pt, black}] table [
                    x=scenario, y=system_total_waiting_time_mean, col sep=comma, y error=system_total_waiting_time_std
                ] {chapters/evaluation/results/diff-waiting-time/Baseline_Actuated.csv};
            \addlegendentry{Baseline Actuated}
        \end{axis}
    \end{tikzpicture}
\end{figure}

\subsubsection{Anzahl angekommener Fahrzeuge}

\begin{figure}[H]
    \centering
    \begin{tikzpicture}
        \begin{axis}[
                ybar,
                bar width=0.25cm,
                width=12cm,
                height=8cm,
                enlarge x limits=0.15,
                ylabel={Anzahl angekommener Fahrzeuge},
                symbolic x coords={evening_peak,morning_peak,random_heavy,uniform},
                xtick=data,
                xticklabels={evening\_peak,morning\_peak,random\_heavy,uniform},
                x tick label style={rotate=45,anchor=east},
                legend style={at={(0.5,-0.35)}, anchor=north, legend columns=-2},
                ymajorgrids=true,
                grid style=dashed,
            ]

            % Baseline FixedTime
            \addplot+[error bars/.cd,
                y dir=both, y explicit,
                error bar style={line width=1pt, black}] table [
                    x=scenario, y=system_total_arrived_mean, col sep=comma, y error=system_total_arrived_std
                ] {chapters/evaluation/results/diff-waiting-time/Baseline_FixedTime.csv};
            \addlegendentry{Baseline FixedTime}

            % RL Modell 1
            \addplot+[error bars/.cd,
                y dir=both, y explicit,
                error bar style={line width=1pt, black}] table [
                    x=scenario, y=system_total_arrived_mean, col sep=comma, y error=system_total_arrived_std
                ] {chapters/evaluation/results/diff-waiting-time/ppo_sumo_456_2025-08-18_01-18-32_456.csv};
            \addlegendentry{Model 1}

            % RL Modell 2
            \addplot+[error bars/.cd,
                y dir=both, y explicit,
                error bar style={line width=1pt, black}] table [
                    x=scenario, y=system_total_arrived_mean, col sep=comma, y error=system_total_arrived_std
                ] {chapters/evaluation/results/diff-waiting-time/ppo_sumo_13755_2025-08-18_04-48-47_13755.csv};
            \addlegendentry{Model 2}

            % RL Modell 3
            \addplot+[error bars/.cd,
                y dir=both, y explicit,
                error bar style={line width=1pt, black}] table [
                    x=scenario, y=system_total_arrived_mean, col sep=comma, y error=system_total_arrived_std
                ] {chapters/evaluation/results/diff-waiting-time/ppo_sumo_143534_2025-08-17_23-30-08_143534.csv};
            \addlegendentry{Model 3}

            % RL Modell 4
            \addplot+[error bars/.cd,
                y dir=both, y explicit,
                error bar style={line width=1pt, black}] table [
                    x=scenario, y=system_total_arrived_mean, col sep=comma, y error=system_total_arrived_std
                ] {chapters/evaluation/results/diff-waiting-time/ppo_sumo_635768_2025-08-18_03-03-29_635768.csv};
            \addlegendentry{Model 4}
        \end{axis}
    \end{tikzpicture}
\end{figure}

\begin{figure}[H]
    \centering
    \begin{tikzpicture}
        \begin{axis}[
                ybar,
                bar width=0.25cm,
                width=12cm,
                height=8cm,
                enlarge x limits=0.15,
                ylabel={Anzahl angekommener Fahrzeuge},
                symbolic x coords={evening_peak,morning_peak,random_heavy,uniform},
                xtick=data,
                xticklabels={evening\_peak,morning\_peak,random\_heavy,uniform},
                x tick label style={rotate=45,anchor=east},
                legend style={at={(0.5,-0.35)}, anchor=north, legend columns=-2},
                ymajorgrids=true,
                grid style=dashed,
            ]

            % Baseline Actuated
            \addplot+[error bars/.cd,
                y dir=both, y explicit,
                error bar style={line width=1pt, black}] table [
                    x=scenario, y=system_total_arrived_mean, col sep=comma, y error=system_total_arrived_std
                ] {chapters/evaluation/results/diff-waiting-time/Baseline_Actuated.csv};
            \addlegendentry{Baseline Actuated}
        \end{axis}
    \end{tikzpicture}
\end{figure}


\subsubsection{Durchschnitt fahrender Fahrzeuge}

\begin{figure}[H]
    \centering
    \begin{tikzpicture}
        \begin{axis}[
                ybar,
                bar width=0.25cm,
                width=12cm,
                height=8cm,
                enlarge x limits=0.15,
                ylabel={Durchschnitt fahrender Fahrzeuge},
                symbolic x coords={evening_peak,morning_peak,random_heavy,uniform},
                xtick=data,
                xticklabels={evening\_peak,morning\_peak,random\_heavy,uniform},
                x tick label style={rotate=45,anchor=east},
                legend style={at={(0.5,-0.35)}, anchor=north, legend columns=-2},
                ymajorgrids=true,
                grid style=dashed,
            ]

            % Baseline FixedTime
            \addplot+[error bars/.cd,
                y dir=both, y explicit,
                error bar style={line width=1pt, black}] table [
                    x=scenario, y=system_total_running_mean, col sep=comma, y error=system_total_running_std
                ] {chapters/evaluation/results/diff-waiting-time/Baseline_FixedTime.csv};
            \addlegendentry{Baseline FixedTime}


            % RL Modell 1
            \addplot+[error bars/.cd,
                y dir=both, y explicit,
                error bar style={line width=1pt, black}] table [
                    x=scenario, y=system_total_running_mean, col sep=comma, y error=system_total_running_std
                ] {chapters/evaluation/results/diff-waiting-time/ppo_sumo_456_2025-08-18_01-18-32_456.csv};
            \addlegendentry{Model 1}

            % RL Modell 2
            \addplot+[error bars/.cd,
                y dir=both, y explicit,
                error bar style={line width=1pt, black}] table [
                    x=scenario, y=system_total_running_mean, col sep=comma, y error=system_total_running_std
                ] {chapters/evaluation/results/diff-waiting-time/ppo_sumo_13755_2025-08-18_04-48-47_13755.csv};
            \addlegendentry{Model 2}

            % RL Modell 3
            \addplot+[error bars/.cd,
                y dir=both, y explicit,
                error bar style={line width=1pt, black}] table [
                    x=scenario, y=system_total_running_mean, col sep=comma, y error=system_total_running_std
                ] {chapters/evaluation/results/diff-waiting-time/ppo_sumo_143534_2025-08-17_23-30-08_143534.csv};
            \addlegendentry{Model 3}

            % RL Modell 4
            \addplot+[error bars/.cd,
                y dir=both, y explicit,
                error bar style={line width=1pt, black}] table [
                    x=scenario, y=system_total_running_mean, col sep=comma, y error=system_total_running_std
                ] {chapters/evaluation/results/diff-waiting-time/ppo_sumo_635768_2025-08-18_03-03-29_635768.csv};
            \addlegendentry{Model 4}
        \end{axis}
    \end{tikzpicture}
\end{figure}


\begin{figure}[H]
    \centering
    \begin{tikzpicture}
        \begin{axis}[
                ybar,
                bar width=0.25cm,
                width=12cm,
                height=8cm,
                enlarge x limits=0.15,
                ylabel={Durchschnitt fahrender Fahrzeuge},
                symbolic x coords={evening_peak,morning_peak,random_heavy,uniform},
                xtick=data,
                xticklabels={evening\_peak,morning\_peak,random\_heavy,uniform},
                x tick label style={rotate=45,anchor=east},
                legend style={at={(0.5,-0.35)}, anchor=north, legend columns=-2},
                ymajorgrids=true,
                grid style=dashed,
            ]
            % Baseline Actuated
            \addplot+[error bars/.cd,
                y dir=both, y explicit,
                error bar style={line width=1pt, black}] table [
                    x=scenario, y=system_total_running_mean, col sep=comma, y error=system_total_running_std
                ] {chapters/evaluation/results/diff-waiting-time/Baseline_Actuated.csv};
            \addlegendentry{Baseline Actuated}
        \end{axis}
    \end{tikzpicture}
\end{figure}


\subsubsection{Durchschnittsgeschwindigkeit}

\begin{figure}[H]
    \centering
    \begin{tikzpicture}
        \begin{axis}[
                ybar,
                bar width=0.25cm,
                width=12cm,
                height=8cm,
                enlarge x limits=0.15,
                ylabel={Durchschnittsgeschwindigkeit},
                symbolic x coords={evening_peak,morning_peak,random_heavy,uniform},
                xtick=data,
                xticklabels={evening\_peak,morning\_peak,random\_heavy,uniform},
                x tick label style={rotate=45,anchor=east},
                legend style={at={(0.5,-0.35)}, anchor=north, legend columns=-2},
                ymajorgrids=true,
                grid style=dashed,
            ]

            % Baseline FixedTime
            \addplot+[error bars/.cd,
                y dir=both, y explicit,
                error bar style={line width=1pt, black}] table [
                    x=scenario, y=system_mean_speed_mean, col sep=comma, y error=system_mean_speed_std
                ] {chapters/evaluation/results/diff-waiting-time/Baseline_FixedTime.csv};
            \addlegendentry{Baseline FixedTime}

            % RL Modell 1
            \addplot+[error bars/.cd,
                y dir=both, y explicit,
                error bar style={line width=1pt, black}] table [
                    x=scenario, y=system_mean_speed_mean, col sep=comma, y error=system_mean_speed_std
                ] {chapters/evaluation/results/diff-waiting-time/ppo_sumo_456_2025-08-18_01-18-32_456.csv};
            \addlegendentry{Model 1}

            % RL Modell 2
            \addplot+[error bars/.cd,
                y dir=both, y explicit,
                error bar style={line width=1pt, black}] table [
                    x=scenario, y=system_mean_speed_mean, col sep=comma, y error=system_mean_speed_std
                ] {chapters/evaluation/results/diff-waiting-time/ppo_sumo_13755_2025-08-18_04-48-47_13755.csv};
            \addlegendentry{Model 2}

            % RL Modell 3
            \addplot+[error bars/.cd,
                y dir=both, y explicit,
                error bar style={line width=1pt, black}] table [
                    x=scenario, y=system_mean_speed_mean, col sep=comma, y error=system_mean_speed_std
                ] {chapters/evaluation/results/diff-waiting-time/ppo_sumo_143534_2025-08-17_23-30-08_143534.csv};
            \addlegendentry{Model 3}

            % RL Modell 4
            \addplot+[error bars/.cd,
                y dir=both, y explicit,
                error bar style={line width=1pt, black}] table [
                    x=scenario, y=system_mean_speed_mean, col sep=comma, y error=system_mean_speed_std
                ] {chapters/evaluation/results/diff-waiting-time/ppo_sumo_635768_2025-08-18_03-03-29_635768.csv};
            \addlegendentry{Model 4}
        \end{axis}
    \end{tikzpicture}
\end{figure}


\begin{figure}[H]
    \centering
    \begin{tikzpicture}
        \begin{axis}[
                ybar,
                bar width=0.25cm,
                width=12cm,
                height=8cm,
                enlarge x limits=0.15,
                ylabel={Durchschnittsgeschwindigkeit},
                symbolic x coords={evening_peak,morning_peak,random_heavy,uniform},
                xtick=data,
                xticklabels={evening\_peak,morning\_peak,random\_heavy,uniform},
                x tick label style={rotate=45,anchor=east},
                legend style={at={(0.5,-0.35)}, anchor=north, legend columns=-2},
                ymajorgrids=true,
                grid style=dashed,
            ]
            % Baseline Actuated
            \addplot+[error bars/.cd,
                y dir=both, y explicit,
                error bar style={line width=1pt, black}] table [
                    x=scenario, y=system_mean_speed_mean, col sep=comma, y error=system_mean_speed_std
                ] {chapters/evaluation/results/diff-waiting-time/Baseline_Actuated.csv};
            \addlegendentry{Baseline Actuated}
        \end{axis}
    \end{tikzpicture}
\end{figure}



% ggf. weitere Metriken: stopped, arrived/departed

\subsection{Reward: Queue}
Die zweite Gruppe zielt auf die Minimierung der Warteschlangenlänge.


% Text mit Interpretation: RL reduziert Staus, wirkt sich auf Durchfluss aus etc.

\subsection{Reward: Reale Welt}
Diese Reward-Definition kombiniert verschiedene Faktoren (Durchfluss, Stauaufbau, Phasenwechsel).



% Text: Ausgewogenere Performance, weniger extreme Optimierung, trade-offs beschreiben

\subsection{Reward: Emissionen}
Für die Emissions-basierten Modelle wird zusätzlich die CO\textsubscript{2}-Emission als zentrale Metrik betrachtet.


Die RL-Modelle erreichen hier eine deutliche Reduktion der Emissionen im Vergleich zu den Baselines,
teilweise jedoch auf Kosten längerer Wartezeiten.
Dies zeigt die Zielkonflikte zwischen ökologischen und verkehrlichen Optimierungskriterien.

\subsection{Robustheit und Replikationsanalyse}
Um die Stabilität der Ergebnisse zu bewerten, werden die Verteilungen über
\begin{itemize}
    \item die 4 Trainingsseeds pro Reward-Variante,
    \item die 10 Evaluations-Episoden pro Szenario
\end{itemize}
analysiert.
Boxplots verdeutlichen die Streuung.
Die RL-Modelle zeigen dabei konsistente Verbesserungen,
auch wenn die Varianz zwischen den Seeds nicht vernachlässigbar ist.

\subsection{Zusammenfassung}

\begin{itemize}
    \item \textbf{Diff-Waiting-Time:} Starke Reduktion der Wartezeit, stabil über Szenarien hinweg.
    \item \textbf{Queue:} Effektive Stauvermeidung, aber teils geringere Geschwindigkeit.
    \item \textbf{Reale Welt:} Ausgewogenes Verhalten, moderate Verbesserungen ohne starke Einbußen.
    \item \textbf{Emissionen:} Reduktion der CO\textsubscript{2}-Emissionen, dafür teils höhere Wartezeiten.
\end{itemize}
